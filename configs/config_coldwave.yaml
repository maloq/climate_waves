data:
  features_dir: climate_data/features
  feature_file_template: "features_{year}.nc"
  target_dir: climate_data/target/target_cold_waves_span_30_threshold_7
  target_file_template: "extemp_minus_7_{year}.nc"
  target_var: extemp_minus
  latitude_range: [40.0, 60.0]
  longitude_range: [30.0, 120.0]
  train_years: [2017, 2018, 2019, 2020, 2021, 2022]
  test_years: [2023, 2024]
  sample_fraction: 0.1
  random_seed: 42

features: 
- geopotential_h00_lvl850
- specific_humidity_h00_lvl850
- u_component_of_wind_h00_lvl850
- u_component_of_wind_h00_lvl1000
- v_component_of_wind_h00_lvl850
- v_component_of_wind_h00_lvl1000
- temperature_h00_lvl850
- temperature_h00_lvl925
- temperature_h00_lvl1000
- anor
- isor
- z
- sdfor
- sdor

# Feature engineering configuration
# Set feature_engineering.enabled to true to generate derived features
feature_engineering:
  enabled: true  # Set to true to enable feature engineering
  
  # Temporal/seasonality features (cyclical encoding)
  temporal:
    month: true          # Month of year (1-12)
    day_of_year: true    # Day of year (1-365)
    sin_cos_annual: true # Sin/cos encoding of annual cycle (captures seasonality properly)
    sin_cos_semiannual: false  # Sin/cos encoding of 6-month cycle (optional)
  
  # Temporal lag features - look back N days
  lag:
    variables:
      - temperature_h00_lvl850
      - temperature_h00_lvl925
      - temperature_h00_lvl1000

    lags: [1, 3, 7]  # 1, 3, and 7 days ago
  
  # Exponential weighted moving averages - smooth trends
  ewm:
    variables:
      - temperature_h00_lvl850
      - temperature_h00_lvl925
      - temperature_h00_lvl1000
    spans: [3, 7, 14, 30]  # 3-day, weekly, bi-weekly, monthly smoothing
  
  # Spatial neighborhood statistics
  spatial:
    variables:
      - temperature_h00_lvl850
      - temperature_h00_lvl1000
      
    window_sizes: [5]  
    stats: [mean, std]    # Mean and standard deviation
  
  # Spatial gradients (rate of change across space)
  gradients:
    variables:
      - temperature_h00_lvl850
      - temperature_h00_lvl1000
  
  # Temporal differences (change from N days ago)
  temporal_diff:
    variables:
      - temperature_h00_lvl850
      - temperature_h00_lvl1000
    periods: [1, 3, 7, 14, 30] 

# Spatio-Temporal Label Smoothing
# Instead of hard 0/1 targets, "smear" heatwave labels into surrounding days/locations
# A day next to a heatwave becomes 0.3-0.5 instead of 0
label_smoothing:
  enabled: false  # Set to true to enable label smoothing
  
  # Temporal smoothing parameters
  temporal_sigma: 1.5      # Gaussian sigma for temporal smoothing (in days)
  temporal_radius: 3       # Number of days to consider for smoothing
  
  # Spatial smoothing parameters  
  spatial_sigma: 1.0       # Gaussian sigma for spatial smoothing (in grid cells)
  spatial_radius: 2        # Number of grid cells to consider
  
  # Output value range
  max_smooth_value: 1.0    # Maximum label value (for heatwave days)
  min_smooth_value: 0.0    # Minimum label value (for background)

model:
  # CatBoost training parameters
  iterations: 1200
  learning_rate: 0.082
  depth: 6
  loss_function: Logloss
  eval_metric: F1
  l2_leaf_reg: 1.128
  random_seed: 42
  
  task_type: GPU                  # Device: CPU or GPU
  
  # Inference parameters
  decision_threshold: 0.512
  verbose: 10
  bootstrap_type: Bayesian
  bagging_temperature: 1.49
  use_class_weights: true
  class_weight_ratio: 6.14
  grow_policy: Lossguide
  max_leaves: 18
  min_data_in_leaf: 46  

training:
  validation_size: 0.2
  shuffle: true
  class_weights: null  # e.g. [1.0, 3.0] to rebalance classes

output:
  model_path: artifacts/coldwave/coldwave_catboost.cbm
  predictions_dir: artifacts/coldwave/predictions
